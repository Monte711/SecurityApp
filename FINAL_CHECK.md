# –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã - Step 5 ‚úÖ

## –î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: 20 –∞–≤–≥—É—Å—Ç–∞ 2025

## üéØ –¶–µ–ª—å Step 5
–°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—á–∏–π –ø–∞–π–ø–ª–∞–π–Ω —Å–±–æ—Ä–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ **–ù–∏–∫–∞–∫–∏—Ö –∑–∞–≥–ª—É—à–µ–∫ ‚Äî –∫–∞–∂–¥–∞—è —á–∞—Å—Ç—å –¥–æ–ª–∂–Ω–∞ —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å**
- ‚úÖ **–í–µ—Å—å –ø—Ä–æ–¥—É–∫—Ç ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ**

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–∞–π–ø–ª–∞–π–Ω–∞:
1. **Log Generator** (`scripts/log_generator.py`) - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. **FastAPI Ingest** (`ingest-api/main.py`) - API –ø—Ä–∏–µ–º–∞ —Å–æ–±—ã—Ç–∏–π  
3. **Redis Streams** - –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
4. **Redis-to-OpenSearch Worker** (`scripts/redis_to_opensearch.py`) - –û–±—Ä–∞–±–æ—Ç—á–∏–∫
5. **OpenSearch** - –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
6. **OpenSearch Dashboards** - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:
```
Log Generator ‚Üí FastAPI (/ingest/security) ‚Üí Redis Stream ‚Üí Worker ‚Üí OpenSearch ‚Üí Dashboard
```

## ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã

### 1. –°–µ—Ä–≤–∏—Å—ã Docker
```
NAME                  STATUS                    PORTS
cybersec_dashboards   Up 16 minutes (healthy)   0.0.0.0:5601->5601/tcp
cybersec_ingest_api   Up 10 minutes (healthy)   0.0.0.0:8000->8000/tcp  
cybersec_opensearch   Up 16 minutes (healthy)   0.0.0.0:9200->9200/tcp
cybersec_redis        Up 16 minutes (healthy)   0.0.0.0:6379->6379/tcp
```

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
```bash
python log_generator.py --rate 2 --duration 5
# ‚úÖ –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: 10
# ‚ùå –û—à–∏–±–æ–∫: 0
# ‚ö° –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞: 1.97 —Å–æ–±—ã—Ç–∏–π/—Å–µ–∫
```

### 3. –î–∞–Ω–Ω—ã–µ –≤ OpenSearch
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π**: 32
- **–ò–Ω–¥–µ–∫—Å**: `security-events-2025.08.20`
- **–°—Ç–∞—Ç—É—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏**: –í—Å–µ —Å–æ–±—ã—Ç–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã

### 4. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
```json
{
  "event_id": "gen-000001-1755700647",
  "timestamp": "2025-08-20T14:37:27.631997Z",
  "source": "vulnerability-scanner",
  "threat_type": "vulnerability",
  "description": "–ù–∞–π–¥–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ Linux",
  "severity": "critical",
  "metadata": {
    "generated": true,
    "generator_version": "1.0.0",
    "event_number": 1
  },
  "severity_ru": "–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π",
  "threat_type_ru": "—É—è–∑–≤–∏–º–æ—Å—Ç—å"
}
```

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–ª–µ–º metadata
**–û–ø–∏—Å–∞–Ω–∏–µ**: OpenSearch –ø–æ–ª—É—á–∞–ª –æ—à–∏–±–∫—É `mapper_parsing_exception` –¥–ª—è –ø–æ–ª—è `metadata`
**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ª–µ `metadata` —Å–æ—Ö—Ä–∞–Ω—è–ª–æ—Å—å –≤ Redis –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞, –∞ –Ω–µ –∫–∞–∫ JSON –æ–±—ä–µ–∫—Ç
**–†–µ—à–µ–Ω–∏–µ**: 
1. –û–±–Ω–æ–≤–ª–µ–Ω `publish_to_stream()` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
2. –û–±–Ω–æ–≤–ª–µ–Ω `process_stream_message()` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞–∑–±–æ—Ä–∞ Python dict —Å—Ç—Ä–æ–∫
3. –°–æ–∑–¥–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π mapping –≤ OpenSearch —Å `"metadata": {"type": "object"}`

### –£–ª—É—á—à–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `ast.literal_eval()` –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞ Python dict —Å—Ç—Ä–æ–∫
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ Redis Streams
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã OpenSearch —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ–ª–µ–π

## üåê –†—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

### FastAPI –ø–µ—Ä–µ–≤–æ–¥—ã
```python
severity_translations = {
    'critical': '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π',
    'high': '–≤—ã—Å–æ–∫–∏–π', 
    'medium': '—Å—Ä–µ–¥–Ω–∏–π',
    'low': '–Ω–∏–∑–∫–∏–π',
    'info': '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π'
}

threat_type_translations = {
    'exploit': '—ç–∫—Å–ø–ª–æ–π—Ç',
    'malware': '–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û',
    'phishing': '—Ñ–∏—à–∏–Ω–≥',
    'vulnerability': '—É—è–∑–≤–∏–º–æ—Å—Ç—å',
    'intrusion': '–≤—Ç–æ—Ä–∂–µ–Ω–∏–µ'
    # ... –∏ —Ç.–¥.
}
```

### Log Generator —Ä—É—Å—Å–∫–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è
- "–ù–∞–π–¥–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ Linux"
- "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É–≥—Ä–æ–∑–∞ —Ç–∏–ø–∞ ransomware"
- "–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Å–µ—Ç–∏"

## üìä Dashboard –¥–æ—Å—Ç—É–ø
- **URL**: http://localhost:5601
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω
- **–î–∞–Ω–Ω—ã–µ**: 32 —Å–æ–±—ã—Ç–∏—è –≥–æ—Ç–æ–≤—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

## üß™ –†–µ–∂–∏–º—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –†–∞–∑–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
```bash
python log_generator.py --batch 10
```

### 2. –ü–æ—Ç–æ–∫–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è  
```bash
python log_generator.py --rate 1 --duration 30
```

### 3. –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
```bash
python log_generator.py --rate 10 --duration 10
```

## üìã –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ Git

### –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫:
- ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç  
- ‚úÖ –°–æ–±—ã—Ç–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ OpenSearch
- ‚úÖ –†—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ Dashboard –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

### –§–∞–π–ª—ã –¥–ª—è –∫–æ–º–º–∏—Ç–∞:
- `ingest-api/main.py` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `publish_to_stream()`
- `scripts/redis_to_opensearch.py` - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ metadata
- `scripts/log_generator.py` - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å —Ä—É—Å—Å–∫–∏–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- `docs/DASHBOARD_GUIDE.md` - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Dashboard
- `docs/dashboard-config.json` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Step 5 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω!**

–°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
–æ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Üí —á–µ—Ä–µ–∑ API ‚Üí –æ—á–µ—Ä–µ–¥—å ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫—É ‚Üí —Ö—Ä–∞–Ω–µ–Ω–∏–µ ‚Üí –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é

–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
- ‚úÖ –†–µ–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –±–µ–∑ –∑–∞–≥–ª—É—à–µ–∫
- ‚úÖ –†—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
